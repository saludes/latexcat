<?xml version="1.0" encoding="UTF-8" ?>

<chapter xml:id="fourier-series" xmlns:xi="http://www.w3.org/2001/XInclude">

  <title>Series de Fourier</title>
  
  <introduction>
    <p>
      Las series de Fourier sirven para analizar procesos periódicos en el tiempo;
      por lo general, en esta asignatura hablaremos de procesos físicos.
      Ejemplos pueden ser
      <ul>
	<li>
	  la evolución <m>U=U(t):\RR\to\RR</m> de la tensión eléctrica en un circuito, como función del tiempo;
	</li>
	<li>
	  la evolución <m>T=T(t):\RR\to\RR</m> de la temperatura de un sólido o un gas, también como función del tiempo;
	</li>
	<li>
	  la intensidad de luz o color en una fotografía, etc.
	</li>
	</ul>
    </p>
    <p>
      Es importante entender que los fundamentos matemáticos de la series y transformadas de Fourier
      que tratamos aquí forman la base de muchas aplicaciones en el mundo real.
      Sin embargo, en el tiempo que tenemos disponibles en esta asignatura no podemos hablar mucho de estas aplicaciones.
      Como por otra parte sí es un tema importante, damos enlaces a
      <url href="https://dsp.stackexchange.com/questions/69/why-is-the-fourier-transform-so-important">tres</url>
      <url href="https://math.stackexchange.com/questions/579453/real-world-application-of-fourier-series">páginas</url>
      <url href="https://www.engr.sjsu.edu/trhsu/Chapter%206%20Fourier%20series.pdf">web</url>.
      Puesto que seguramente estos enlaces se quedarán obsoletos en algún momento,
      les invitamos a hacer su propia búsqueda.
      Como en todas las materias, saber en qué se aplicará les ayudará a entender mucho mejor los contenidos.
    </p>

    <p>
      Piensen que <url href="https://en.wikipedia.org/wiki/Joseph_Fourier">Joseph Fourier</url>,
      el primero en desarrollar estas ideas, vivió entre 1768 y 1830, y que mucha gente muy lista se ha dedicado a refinar
      y mejorarlas desde entonces hasta hoy.
    </p>

  </introduction>

  <section xml:id="seccion-modelizar">
    <title>De la realidad al modelo</title>

    <p>
      Modelizar un tal proceso físico
      mediante una función <m>f:\RR^m\to\RR^n</m> de una (en el caso <m>m=1</m>)
      o varias (si <m>m\ge 2</m>) variables reales que devuelve un valor (<m>n=1</m>) real, o varios de ellos (<m>n\ge2</m>).
      Usando diferentes valores de <m>m</m> y <m>n</m> podemos modelizar, por ejemplo, los siguientes fenómenos:
    </p>      
    <table xml:id="funciones">
      <title>
	Ejemplos para funciones de diversos números de variables
      </title>
      <tabular top="major">
	<col />
	<col width="25%" />
	<col width="30%" />
	<col width="35%" />
	<row valign="top" bottom="medium">
	  <cell></cell>
	  <cell><m>n=1</m></cell>
	  <cell><m>n=2</m></cell>
	  <cell><m>n=3</m></cell>
	</row>
	<row valign="top" bottom="minor">
	  <cell><m>m=1</m></cell>
	  <cell>
	    <p>
	      evolución <m>R:\RR\to\RR</m>, <m>t\mapsto R(t)</m> del factor <m>R</m>
	      de una epidemia en el tiempo
	    </p>
	  </cell>
	  <cell>
	    <p>
	      trayectoria <m>f:\RR\to\RR^2</m>, <m>t\mapsto (f_x(t), f_y(t))</m>
	      de una particula en el plano
	    </p>
	  </cell>
	  <cell>
	    <p>
	      trayectoria <m>f:\RR\to\RR^3</m>, <m>t\mapsto (f_x(t), f_y(t), f_z(t))</m>
	      de una particula en el espacio
	    </p>
	  </cell>
	</row>
	<row valign="top" bottom="minor">
	  <cell><m>m=2</m></cell>
	  <cell>
	    <p>
	      valor de gris <m>g:\RR^2\to\RR</m>, <m>(x,y)\mapsto g(x,y)</m>
	      del píxel <m>(x,y)</m> de una fotografía
	    </p>
	  </cell>
	  <cell>
	    <p>
	      campo vectorial <m>\vec f:\RR^2\to\RR^2</m>, <m>(x,y)\mapsto (f_1(x,y), f_2(x,y))</m>:
	      a cada punto del plano se le asigna un vector
	    </p>
	  </cell>
	  <cell>
	    <p>
	      foto de color<m>f:\RR^2\to\RR^3</m>, <m>(x,y)\mapsto (r(x,y), g(x,y), b(x,y))</m>:
	      a cada píxel se le asignan sus valores rojo, verde, y amarillo
	    </p>
	  </cell>
	</row>
      </tabular>
    </table>
  
    <p>      
      En esta asignatura, únicamente trataremos el caso más sencillo de <m>n=m=1</m>,
      es decir, de <em>funciones reales de una variable real</em>.
      Sin embargo, las técnicas que aprenderemos se pueden extender sin problemas a los demás casos.
    </p>

    <p>
      La variable real, en esta asignatura, siempre será
      o bien <m>t</m>, para denotar procesos que dependen del tiempo,
      o bien <m>x</m>, para denotar procesos que dependen del espacio.
      Normalmente modelizaremos procesos en el tiempo,
      y por tanto usaremos la variable <m>t</m> y funciones <m>f=f(t)</m>.
    </p>

    <p>
      En cuanto a notación, escribiremos <m>f</m> para una función si no nos importa de qué variable depende,
      y por ejemplo <m>f(t)</m> si depende del tiempo, o <m>f(x)</m> si depende de una coordenada espacial.
    </p>

  </section>


  <section xml:id="seccion-intuicion-series">
    <title>Recursos online: La intuición detrás de la serie de Fourier</title>

    <introduction>
    <p>
      Por suerte, cada día hay más recursos excelentes disponibles en la red que explican la intuición detrás de las series de Fourier.
      Coleccionamos aquí unos ejemplos.
    </p>
    </introduction>

    <subsection>
      <title>
	Series de Fourier de señales "lineales"
      </title>
      
      <ol>

	<li>
	  En <url href="https://www.engr.sjsu.edu/trhsu/Chapter%206%20Fourier%20series.pdf">esta presentación</url> hay unos ejemplos sobre aplicaciones de las series de Fourier
	</li>

	<li>
	  Este <url href="https://www.mdpi.com/1424-8220/18/1/297/pdf">artículo</url> describe cómo funcionan las aplicaciones cuenta-pasos en los smartphones. Spoiler: Usan las series de Fourier
	</li>
	
	<li>
	  <url href="http://www.falstad.com/fourier/">Aquí</url> hay un applet de java que permite experimentar con los coeficientes de Fourier.
	</li>

	<li>
	  En la <url href="http://en.wikipedia.org/wiki/Fourier_series">página de la Wikipedia</url> se puede <url href="https://upload.wikimedia.org/wikipedia/commons/2/2b/Fourier_series_and_transform.gif">encontrar</url> una animación que explica el concepto.
	</li>

	<li>
	  En <url href="https://betterexplained.com/articles/an-interactive-guide-to-the-fourier-transform/">este artículo</url> se explica la transformada de Fourier en analogía a las recetas de unos cócteles.
	</li>

      </ol>
    </subsection>

    <subsection>
      <title>
	Series de Fourier de señales "cíclicas"
      </title>

      <p>
	  Hasta ahora, las señales que analizamos han sido representadas como funciones del tiempo.
	  A continuación presentamos series de Fourier de curvas en el plano,
	  convertidas en sumas de circunferencias que giran con diferentes velocidades.
	  Veremos a continuación que se trata de la misma idea matemática.
      </p>

      <ol>

	<li>
	  <url href="http://bl.ocks.org/jinroh/7524988">Aqui</url> hay una visualización del análisis de Fourier hecha con la librería <url href="https://en.wikipedia.org/wiki/D3.js">D3</url>,
	  que da una primera impresión de esta idea.
	</li>

	<li>
	  En <url href="http://www.jezzamon.com/fourier/">esta dirección</url> hay una animación más detallada.
	</li>
	
	<li>
	  <url href="https://www.myfourierepicycles.com/">Aquí</url> hay un applet de java que permite convertir un dibujo propio en unos epiciclos de Fourier.
	</li>

      </ol>
    </subsection>

    <subsection>
      <title>
	Más aplicaciones y recursos para de las series de Fourier
      </title>

      <ol>
	<li>
	  En <url href="https://dsp.stackexchange.com/questions/69/why-is-the-fourier-transform-so-important">stackexchange</url>
	  hay muchas respuestas, con ejemplos, a la pregunta por qué es importante la transformada de Fourier.
	</li>

	<li>
	  El inigualable <url href="https://www.3blue1brown.com/about">Grant</url> <url href="https://en.wikipedia.org/wiki/3Blue1Brown">Sanderson</url> tiene un <url href="https://www.youtube.com/channel/UCYO_jab_esuFRV4b17AJtAw">canal</url> en youtube donde colecciona sus vídeos fantásticos.

	  Destacamos dos de ellos:

	  <figure>
	    <title>Fourier visualized</title>
	    <caption>Introducción a las series de Fourier de 3blue1brown</caption>
	    <idx><h>Video Fourier Visualized de 3blue1brown</h></idx>
	    <video xml:id="fourier-visualized-3blue1brown" youtube="spUNpyF58BY" width="100%" preview="images/3b1b-video1-preview.png"/>
	  </figure>
	  
	  <figure>
	    <title>But what is a Fourier series?</title>
	    <caption>Introducción a las series de Fourier de 3blue1brown</caption>
	    <idx><h>Video Introducción a las series de Fourier de 3blue1brown</h></idx>
	    <video xml:id="fourier-series-3blue1brown" youtube="r6sGWTCMz2k" width="100%" preview="images/3b1b-video2-preview.png"/>
	  </figure>
	</li>

	<li>
	  La asignatura
	  <url href="https://see.stanford.edu/Course/EE261">EE261 - The Fourier Transform and its Applications</url>
	  de Brad Osgood en la Universidad de Stanford, junto con
	  <url href="https://see.stanford.edu/materials/lsoftaee261/book-fall-07.pdf">el libro de texto</url>
	  que lo acompaña son unos recursos excelentes para ingenieros.
	</li>

	<li>
	  En <url href="https://observablehq.com/search?query=fourier">esta url</url> hay más recursos.
	</li>
      </ol>
    </subsection>
    
  </section>
  
  <section xml:id="seccion-procesos-periodicos">
    <title>Procesos periódicos</title>
    <introduction>
    <p>
      <url href="https://www.engr.sjsu.edu/trhsu/Chapter%206%20Fourier%20series.pdf">Ejemplos de procesos periódicos</url>
      que se pueden analizar mediante las series de Fourier son

      <ul>
	<li>
	  Las fuerzas que actúan sobre una aguja de una máquina de coser en operación
	</li>

	<li>
	  La evolución en el tiempo de la presión de gas en los cilindros de un motor,
	  y de las fuerzas sobre el eje
	</li>
	  
	<li>
	  La presión de aire sobre la membrana de un micrófono cuando está grabando un sonido
	</li>
      </ul>
    </p>

    <p>
      El modelo matemático para un proceso periódico para nosotros será una función periódica.
    </p>

    <definition xml:id="definicion-periodico">
      <statement>
	<p>
      <ul>
	<li>
	  Una función <m>f:\RR\to\RR</m> es <term>periódica</term>
	  si podemos encontrar un número <m>T\in\RR</m> tal que
	  <me>
	    f(t+T) \ = \ f(t)
	    \qquad\text{para todo } t\in\RR.
	  </me>
	</li>
	<li>
	  Cualquier número <m>T</m> que verifique esta ecuación se llama un <term>periodo</term> de <m>f</m>.
	</li>
	<li>
	  El número <m>T>0</m> <b> más pequeño</b> que verifique esta ecuación se llama el <term>periodo fundamental</term> de <m>f</m>,
	  y muchas veces los escribimos <m>T_0</m>.
	</li>
      </ul>
	</p>
      </statement>
    </definition>

    <observation xml:id="obs-period">
      Una función periódica con período fundamental <m>T</m> es también periódica con período <m>2T, 3T, -5T,\dots</m>
    </observation>
        
    <p>
     Siempre que trabajemos con procesos periódicos hablaremos de la <term>frecuencia</term> que mide el número
     de repeticiones del proceso periódico
    </p>
    
    <definition xml:id="definicion-frecuencia">
      <statement>
	<p>
      <ul>
	<li>
	  La <term>frecuencia</term> de una función <m>f(t)</m> de periodo fundamental <m>T</m> es <m>F=\frac{1}{T}</m>. 
	  Se interpreta como el número de veces que se repite la señal por unidad de medida de la variable independiente. 
	  Si <m>t</m> se mide en segundos, <m>F</m> en <m>\frac{1}{seg}=Hz</m>.
	</li>
	<li>
	  La <term>frecuencia angular</term> de una función <m>f(t)</m> de periodo fundamental <m>T</m> es <m>\omega=2\pi F=\frac{2\pi}{T}</m>. 
	  Se interpreta como el número de veces que que se repite la señal por ciclo (<m>2\pi</m> radianes). Si <m>t</m> se mide en segundos, 
	  <m>\omega</m> en <m>rad/seg</m>.
	</li>
	<li>
	  En el desarrollo de este tema trabajaremos fundamentalmente con frecuencias angulares.
	</li>
      </ul>
	</p>
      </statement>
    </definition>

    <example>
      <p>
	<ol label="(a)">
	  <li>
	    Consideremos la función
	    <m>f(t)=\sin(\pi t)</m>.

	    <figure xml:id="figure-sin-t">
	      <caption><m>f(t)=\sin(\pi t)</m></caption>
	      <image width="80%" xml:id="sin-t" source="images/fig-series-sine.png">
		<description>La función <m>f(t)=\sin(\pi t)</m></description>
	      </image>
	    </figure>
	    
	    Como <m>f(t+2)=
	    \sin(\pi(t+2)) =
	    \sin(\pi t + 2\pi) =
	    \sin(\pi t) = f(t)</m>, el número <m>T=2</m> es un periodo de <m>f</m>,
	    al igual que los números <m>T=-2,0,2,4,6</m>.
	    Puesto que entre todos estos números, el número más pequeño pero positivo es <m>2</m>,
	    el <em>periodo fundamental</em> de <m>f(t)=\sin(\pi t)</m> es <m>T_0=2</m>.
	  </li>
	</ol>
      </p>
    </example>
    </introduction>
    
    <subsection>
      <title>Funciones pares e impares</title>

      <p>
	Las propiedades de una función de ser par o impar no tiene, en principio, nada que ver con la propiedad de un número
	de ser par (divisible entre 2) o impar (dejar resta 1 al dividir entre 2).
	Sin embargo, aunque la <em>propiedad</em> de una función de ser par o impar en sí no tiene mucha relación con los números,
	la <em>interacción</em> de estas propiedades es suficientemente análoga como para justificar este nombre. 
      </p>

      <definition>
	<statement>
	  <p>
	<ol>

	  <li>
	    Una función <m>f:\RR\to\RR</m> es <term>par</term> si
	    <me>
	      f(-x)
	      \ = \
	      f(x)
	      \qquad\text{para todo }
	      x\in\RR.
	    </me>

	    
	  </li>

	  <li>
	    Una función <m>f:\RR\to\RR</m> es <term>impar</term> si
	    <me>
	      f(-x)
	      \ = \
	      -f(x)
	      \qquad\text{para todo }
	      x\in\RR.
	    </me>

	    
	  </li>
	</ol>
	  </p>
	</statement>
      </definition>

      <sidebyside width="45%" margins="auto">
	<figure xml:id="figure-even">
	  <caption>Varias funciones pares</caption>
	  <image xml:id="figure-even1" source="images/fig-series-even-func.png">
	    <description>Varias funciones pares</description>
	  </image>
	</figure>
	  
	<figure xml:id="figure-odd">
	  <caption>Varias funciones impares</caption>
	  <image xml:id="figure-odd1" source="images/fig-series-odd-func.png">
	    <description>Varias funciones impares</description>
	  </image>

	</figure>
      </sidebyside>

      <example>
	<p>
	  Ejemplos de funciones pares son
	  <ul>
	    
	    <li>
	      el valor absoluto <m>x\mapsto |x|</m>
	    </li>

	    <li>
	      funciones de potencia con exponente par: <m>x\mapsto x^2</m>, <m>x\mapsto x^6</m>, etc
	    </li>

	    <li>
	      el coseno <m>x\mapsto\cos(x)</m>
	    </li>
	  </ul>

	  Ejemplos de funciones impares son
	  <ul>
	    
	    <li>
	      la función identidad <m>x\mapsto x</m>
	    </li>

	    <li>
	      funciones de potencia con exponente impar: <m>x\mapsto x^3</m>, <m>x\mapsto x^7</m>, etc
	    </li>

	    <li>
	      el seno <m>x\mapsto\sin(x)</m>
	    </li>
	  </ul>

	</p>
      </example>

      <observation xml:id="prop-even-odd">
      <p>
	Unas <url href="https://en.wikipedia.org/wiki/Even_and_odd_functions#Basic_properties">propiedades</url>
	de funciones pares e impares son

	<ol>
	  <li>
	    Si una función es par e impar a la vez, entonces la función vale 0 en todos los puntos de su dominio.
	  </li>

	  <li>
	    Si una función <m>f(t)</m> es impar y <m>f(0)</m> está definido, entonces <m>f(0)=0</m>.
	  </li>

	  <li>
	    Si una función es impar, su valor absoluto es par.
	  </li>

	  <li>
	    La suma o diferencia de dos funciones pares es par.
	  </li>

	  <li>
	    La suma o diferencia de dos funciones impares es impar.
	  </li>

	  <li>
	    El producto o cociente de dos funciones pares es par.
	  </li>

	  <li>
	    El producto o cociente de dos funciones impares es par.
	  </li>

	  <li>
	    El producto o cociente de una función par y una función impar es impar.
	  </li>

	  <li>
	    Cualquier función <m>f:\RR\to\RR</m> se descompone en una parte par y una parte impar:
	    Si
	    <md>
	      <mrow>
		f_{\text{par}}
		&amp;=
		\frac{f(x) + f(-x)}{2},
	      </mrow>

	      <mrow>
		f_{\text{impar}}
		&amp;=
		\frac{f(x)-f(-x)}{2},
	      </mrow>
	    </md>
	    entonces
	    <me>
	      f(x)
	      \ = \
	      f_{\text{par}}(x) + f_{\text{impar}}(x).
	    </me>
	  </li>
	</ol>
      </p>
      </observation>
      
      <exercise>
	<p>
	  Justifica algunas de estas propiedades.
	</p>
      </exercise>
      
    </subsection>

  </section>
  
  <section xml:id="seccion-analisis-sintesis">
    <title>Analisis y Síntesis de Fourier</title>

    <introduction>
    <p>
      A partir de aquí, consideraremos siempre una función
      <m>f:\RR\to\RR</m>, <m>t\mapsto f(t)</m> periódica con período fundamental <m>T</m> (véase <xref ref="definicion-periodico"/>).
    </p>
    <p>
      Hay dos maneras de expresar la serie de Fourier de <m>f</m>, como <em>serie trigonométrica</em> o <em>serie compleja</em>.
      Común a ambas maneras son los siguientes hechos:
      <ul>
	<li>
	  La existencia de unas funciones específicas que se llaman <em>oscilaciones elementales</em>.
	</li>
	
	<li>
	  Se expresa la función <m>f</m> como una combinación lineal de tales oscilaciones elementales.
	</li>
	
	<li>
	  Lo que caracteriza la función <m>f</m> son los <em>coeficientes</em>
	  mediante los cuales <m>f</m> se expresa a partir de las oscilaciones elementales.
	</li>

	<li>
	  Intervienen expresiones como <m>\frac{2\pi n}{T}</m>.
	  Estas también se pueden expresar como <m>\omega_n </m>, donde
	  <me>
	    \omega_n
	    \ = \
	    \frac{2\pi n}{T} = n\omega
	  </me>
	  siendo <m>\omega=\frac{2\pi}{T}</m> la frecuencia fundamental de la función periódica. Así, <m>\omega_n</m>
	  es el múltiplo <m>n</m>-ésimo de la <term>frecuencia fundamental</term>, y la letra <m>\omega</m> es griega 
	  y se pronuncia <term>omega</term>.
	</li>
	
      </ul>
    </p>

      <definition xml:id="definition-analysis-synthesis">
	<statement>
	  <p>
	<ul>
	  <li>
	    El proceso de pasar de una función conocida a sus coeficientes de Fourier se llama <term>análisis de Fourier</term>.
	    Este término es análogo al concepto de <em>análisis</em> en Quimica,
	    donde también queremos saber (<em>analizar</em>) de qué cosas consiste una substancia dada.
	  </li>

	  <li>
	    El proceso de reconstruir una función a partir de sus coeficientes se llama <term>síntesis de Fourier</term>.
	    También aquí la analogía viene de Quimica, donde queremos <em>sintetizar</em> una substancia a partir de otras substancias que ya tenemos.
	  </li>

	</ul>
	  </p>
	</statement>
      </definition>
      
    </introduction>

    <subsection>
      <title>La serie trigonométrica de Fourier</title>
      <p>
	Hay dos tipos de funciones elementales:
	<ol>
	  <li>
	    Las funciones coseno cuya frecuencia sea un múltiplo de <m>\omega=\frac{2\pi}{T}</m>:
	    <me>
	      \cos\left(\frac{2\pi n}{T}\,t\right)
	      \ = \
	      \cos(\omega_n t),
	      \qquad\text{para }n=0,1,2,\dots
	    </me>
	  </li>

	  <li>
	    Las funciones seno cuya frecuencia sea un múltiplo de <m>\omega=\frac{2\pi}{T}</m>:
	    <me>
	      \sin\left(\frac{2\pi n}{T}\,t\right)
	      \ = \
	      \sin(\omega_n t),
	      \qquad\text{para }n=1,2,\dots
	    </me>
	  </li>
	</ol>

	Aquí hemos usado la abbreviatura
	<me>
	  \omega_n
	  \ = \
	  n\omega
	  \ = \
	  \frac{2\pi n}{T}.
	</me>
      </p>
      
      <note xml:id="note-ac-dc">
	<p>
	  Fíjense bien en que para las funciones coseno permitimos <m>n=0</m>, lo cual corresponde a
	  la función <m>\cos(\frac{2\cdot\pi\cdot0}{T}\,t) = \cos(0) = 1</m>.
	  En la ingeniería eléctrica hay la tradición de llamar a esta función la <term>componente DC</term>,
	  porque una corriente constante se expresa como <em>direct current</em>.
	  Los valores de <m>k</m> diferentes a cero se llaman la <term>componente AC</term>, puesto que varían periódicamente en el tiempo,
	  lo cual se corresponde con una <em>alternating current</em>.
	</p>
      </note>

      <note xml:id="note-period">
	<p>
	  Fíjense también en que el período fundamental tanto de <m>\cos(\omega_n t)</m> como de <m>\sin(\omega_n t)</m> es <m>T/n</m>.
	  Por ejemplo,
	  <me>
	    \cos\left(\omega_n \cdot\frac{T}{n}\right)
	    \ = \
	    \cos\left(\frac{2\pi n}{T}\,\frac{T}{n}\right)
	    \ = \
	    \cos(2\pi)
	    \ = \
	    1.
	  </me>
	  Imaginemos que <m>t</m> va aumentando en valor desde 0, donde <m>\cos(2\pi nt/T)</m> vale 1.
	  La fórmula que acabamos de escribir nos dice que en <m>t=T/n</m> sucede por primera vez que la función
	  <m>\cos(2\pi nt/T)</m> vuelva a valer 1, y por eso <m>T/n</m> es el período de esta función.
	</p>
      </note>
      
      <definition xml:id="analysis-synthesis-series">
	<statement>
	<p>
	  Sea <m>f(t):\RR\to\RR</m> una señal periódica con período <m>T\in\RR</m>.
	</p>

	<p>
	  Las fórmulas para el <term>análisis trigonométrico de Fourier</term> de la función <m>f(t)</m> son
	  <mdn>
	    <mrow xml:id="fourier-trig-a">
	      a_n
	      &amp;=
	      \frac{2}{T}
	      \int_0^{T}
	      f(t)
	      \cos\left(\frac{2\pi n}{T}\, t\right)
	      \dd t,
	      \qquad\text{para } n=0,1,2,\dots,
	    </mrow>

	    <mrow xml:id="fourier-trig-b">
	      b_n
	      &amp;=
	      \frac{2}{T}
	      \int_0^{T}
	      f(t)
	      \sin\left(\frac{2\pi n}{T}\, t\right)
	      \dd t,
	      \qquad\text{para } n=1,2,3,\dots.
	    </mrow>

	  </mdn>
	</p>

	<p>
	  La fórmula para la <term>síntesis trigonométrica de Fourier</term> es
	  <men xml:id="fourier-trig-synthesis">
	    f(t)
	    \ = \
	    \frac{a_0}{2}
	    +
	    \sum_{n=1}^\infty
	    a_n
	    \cos\left(\frac{2\pi n}{T}\, t\right)	  +
	    \sum_{n=1}^\infty
	    b_n
	    \sin\left(\frac{2\pi n}{T}\, t\right).
	  </men>
	</p>
	</statement>
      </definition>
      
      <note xml:id="note-fourier-trig">
	<p>
	  Hay varias observaciones a tener en cuenta:
	  <ol>

	    <li>
	      La notación <m>\sum</m> significa <em>suma</em>. Por ejemplo,
	      <me>
		\sum_{n=1}^3
		a_n
		\cos\left(\frac{2\pi n}{T}\, t\right)
		\ = \
		a_1
		\cos\left(\frac{2\pi t}{T}\right)
		+
		a_2
		\cos\left(\frac{4\pi t}{T}\right)
		+
		a_3
		\cos\left(\frac{6\pi t}{T}\right).
	      </me>
	    </li>	    
	    
	    <li>
	      El hecho que en la fórmula <xref ref="fourier-trig-synthesis"/>
	      el sumando <m>a_0/2</m> sea diferente de todos los demás es una convención, no una necesidad.
	      Existe otra convención, según la cual la fórmula de síntesis es
	      <md>
		<mrow>
		  f(t)
		  &amp;=
		  \widetilde{a_0}
		  +
		  \sum_{n=1}^\infty a_n
		  \cos\left(\frac{2\pi n}{T}\, t\right)	  +
		  \sum_{n=1}^\infty
		  b_n
		  \sin\left(\frac{2\pi n}{T}\, t\right)  
		</mrow>
		<mrow>
		  &amp;=
		  \sum_{n=0}^\infty a_n \cos(\omega_n t)
		  +
		  \sum_{n=1}^\infty b_n \sin(\omega_n t),
		</mrow>
	      </md>
	      pero entonces la fórmula para <m>\widetilde{a_0}</m> cambia a
	      <men xml:id="eq-median">
		\widetilde{a_0}
		\ = \
		\frac{1}{T}\int_0^T f(t) \dd t,
	      </men>
	      y, por tanto, <m>\widetilde{a_0}</m> 
	      es <alert>la mitad</alert> de <m>a_0</m>.
	      No es lo más estándar, pero os aparecerá así en parte del material de la asignatura.
	      <alert>Si se buscan ejemplos y videos en Internet, hay que fijarse muy bien cuál de estas dos convenciones utilizan</alert>.
	      Los resultados para análisis y síntesis dependen de la convención, y no se pueden utilizar sin más en la otra.
	    </li>

	    <li>
	      La fórmula <xref ref="eq-median"/> es el <term>valor medio</term> o <term>promedio</term> de la función <m>f(t)</m>.
	      Por tanto,
	      <alert>
		el coeficiente constante de la serie de Fourier es siempre el valor medio de la función
	      </alert>
	      (en las dos convenciones).
	    </li>

	    <li>
	      El hecho que la integración vaya de 0 a <m>T</m> es arbitrario.
	      De hecho, se puede integrar desde cualquier valor <m>t_0</m> hasta <m>t_0+T</m> sin que el resultado varie;
	      integrar de 0 a <m>T</m> corresponde a escoger <m>t_0=0</m>.
	      Es un buen ejercicio entender por qué es cierto que sale el mismo resultado para cualquier valor de <m>t_0</m>.
	      (Recuerda que <m>f(t)</m> es periódica con período <m>T</m>.)
	    </li>

	    <li>
	      <p>
		Puesto que el cosinus es una función par y el sinus es una función impar,
		los coeficientes de Fourier trigonométricos nos proporcionan directamente la
		descomposición de <m>f(t)</m> en su parte par e impar:

		<men xml:id="eq-par-impar-series">
		  f(t)
		  \ = \
		  \underbrace{
		  \frac{a_0}{2}
		  +
		  \sum_{n=1}^\infty
		  a_n
		  \cos\left(\omega_n t\right)}_{f_{\text{par}}(t)}
		  +
		  \underbrace{
		  \sum_{n=1}^\infty
		  b_n
		  \sin\left(\omega_n t\right)}_{f_{\text{impar}}(t)}.
		</men>

		En particular,
		<ul>
		  <li>
		    si ya sabemos de antemano que la función <m>f(t)</m> es par,
		    no hace falta calcular los coeficientes <m>b_n</m>,
		  </li>

		  <li>
		    y si sabemos que la función <m>f(t)</m> es impar,
		    no hace falta calcular los coeficientes <m>a_n</m>,
		  </li>
		</ul>
		porque se anularán.
	      </p>
	      
	    </li>
	    
	  </ol>
	</p>
      </note>

      <example>
	<p>
	Usamos las fórmulas <xref ref="fourier-trig-a"/> y <xref ref="fourier-trig-b"/> para calcular la serie trigonométrica de Fourier
	de la función <term>diente de sierra</term>, definida por
	<me>
	  f(t)
	  \ = \
	  \frac{t}{\pi}
	  \qquad\text{para } -\pi &lt; t&lt; \pi,
	</me>
	y <term>extendida por periodicidad</term>.
	Eso quiere decir que
	<me>
	  f(t+ 2\pi k)
	  \ = \
	  f(t)
	  \qquad
	  \text{para } -\pi &lt; t &lt; \pi
	  \quad\text{y }\quad k\in\ZZ.
	</me>

	Los coeficientes trigonométricos de Fourier de esta función son como sigue.

	<ol>
	  <li>
	Primero hay que observar que la integral de una función periódica sobre un intervalo de longitud el período
	tiene siempre el mismo valor.
	Por esta razón podemos sustituir en la definición de los coeficientes <m>[0, T]</m> por <m>[-\pi,\pi]</m>: 
	<mdn>
		<mrow>
			a_n &amp;= \frac1{\pi^2}\int_{-\pi}^\pi t \cos(n t)\, dt
		</mrow>
		<mrow xml:id="eq-sierra-bn">
			b_n &amp;= \frac1{\pi^2}\int_{-\pi}^\pi t \sin(n t)\, dt
		</mrow>
	</mdn>
	  </li>

	  <li>
	Observamos también que la función que aparece en la expresión de <m>a_n</m> és impar,
	por <xref ref="prop-even-odd"/> (8),
	de lo que se deduce que <m>a_n=0</m>.
	  </li>

	  <li>
	En cuánto a la segunda integral <xref ref="eq-sierra-bn"/>, se puede integrar por partes tomando
	<m>u=t</m>, <m>dv=\sin(n t)\,dt</m>
	con lo que <m>du=dt</m> i <m>v = -\cos(n t)/n</m>.
	Ahora hay que evaluar <m>uv = - t\cos(n t)/n</m> en <m>t=\pm\pi</m>.
	Como es una función par, será el doble del valor en <m>t=\pi</m>,
	es decir <m>-2\pi(-1)^n/n</m>.
	A esto hay que restarle el valor de la integral de <m>v\,du = -\cos(n t)/n</m>, que es
	<m>-\sin( n t)/n^2</m>, que evaluada en <m>t=\pm\pi</m> da cero.

	Por lo tanto 
	<me>a_n=0; \qquad b_n = -\frac{2(-1)^n}{n\pi}.</me>
	  </li>
	</ol>
	</p>
      </example>

    </subsection>

    <subsection>
      <title>La serie compleja de Fourier</title>
      <p>
	Como funciones elementales usaremos ahora los exponenciales complejos
	<me>
	  e^{\ii \frac{2\pi n}{T}t}
	  \ = \
	  \cos\left(\frac{2\pi n}{T}\,t\right) +
	  \ii
	  \sin\left(\frac{2\pi n}{T}\,t\right)
	</me>
      </p>

      <p>
	La fórmula para el <term>análisis complejo de Fourier</term> de la función <m>f(t)</m> es
	<me>
	  c_n
	  \ = \
	  \frac{1}{T}
	  \int_0^{T}
	  f(t)
	  e^{-\ii\frac{2\pi n}{T}\, t}
	  \dd t,
	  \qquad\text{para } n=0,1,2,\dots,
	</me>

	La fórmula para la <term>síntesis compleja de Fourier</term> es
	<men xml:id="fourier-complex-synthesis">
	  f(t)
	  \ = \
	  \sum_{n=-\infty}^\infty
	  c_n
	  e^{\ii \frac{2\pi n}{T}\, t}
	</men>
      </p>

      <note xml:id="note-fourier-complex">
	<p>
	<ol>
	  <li>
	    Fíjese bien en que en la fórmula de análisis sale <m>e^{-\ii \omega_n t}</m>,
	    pero en la de síntesis sale <m>e^{\ii \omega_n t}</m>.
	  </li>

	</ol>
	</p>
      </note>
      
    </subsection>

    <subsection>
      <title>Convertir la serie trigonométrica en la serie compleja y viceversa</title>

      <theorem>
	<p>
	  Sea <m>f:\RR\to\RR</m> una función periódica con período <m>T</m>, y sea
	  <m>\omega_n = \frac{2\pi n}{T}</m> para <m>n\ge0</m>.
	</p>
	<p>
	  Los coeficientes de la serie trigonométrica de Fourier
	  <me>
	    f(t)
	    \ = \
	    \frac{a_0}{2}
	    +
	    \sum_{n=1}^\infty
	    a_n
	    \cos\left(\omega_n t\right)	  +
	    \sum_{n=1}^\infty
	    b_n
	    \sin\left(\omega_n t\right)
	  </me>

	  y la serie compleja de Fourier

	  <me>
	    f(t)
	    \ = \
	    \sum_{n=-\infty}^\infty
	    c_n
	    e^{\ii \omega_n t}
	  </me>
	  se relacionan de la siguente manera:
	  <mdn>
	    <mrow xml:id="convert-c-to-ab-1">
	      c_0
	      &amp;=
	      a_0/2
	    </mrow>

	    <mrow xml:id="convert-c-to-ab-2">
	      c_n
	      &amp;=
	      (a_n - \ii b_n)/2
	      \qquad\text{para } n>0
	    </mrow>

	    <mrow xml:id="convert-c-to-ab-3">
	      c_{n}
	      &amp;=
	      (a_{|n|} + \ii b_{|n|})/2
	      \qquad\text{para } n&lt;0
	    </mrow>
	  </mdn>
	</p>
	<xi:include href="./proof-coefficient-conversion-series.xml" />

      </theorem>

      <exercises>
	<exercise>
	  <p>
	    Manipulando las fórmulas <xref ref="convert-c-to-ab-1"/>-<xref ref="convert-c-to-ab-3"/>,
	    averigua cómo calcular los coeficientes trigonométricos <m>a_n,b_n</m> a partir de los coeficientes complejos <m>c_n</m>.
	  </p>
	</exercise>

	<exercise>
	  <p>
	    De <xref ref="eq-par-impar-series"/> podemos deducir
	    cómo afecta a los coeficientes trigonométricos <m>a_n,b_n</m>
	    el hecho que <m>f</m> sea par o impar.
	    ¿Cómo afecta a los coeficientes complejos <m>c_n</m>
	    el hecho que <m>f</m> sea par o impar?
	  </p>
	</exercise>
	
      </exercises>
      
    </subsection>

    <subsection>
      <title>
	Armónicos y aproximación de una serie de Fourier
      </title>
      
      <definition>
	<statement>
	  <p>
	    El término 
	    <me>
	      a_n
	      \cos\left(\frac{2\pi n}{T}\, t\right)	  +
	      b_n
	      \sin\left(\frac{2\pi n}{T}\, t\right)  
	    </me>
	    es el <term>armónico <m>n</m>-ésimo</term> de la serie trigonométrica de Fourier de <m>f(t)</m>.
	    Los coeficientes <m>a_n</m> y <m>b_n</m> miden el
	    peso (la importancia) de la frecuencia <m>\omega_n=n\frac{2\pi}{T}</m> en la señal <m>f(t)</m>.
	  </p>
	</statement>
	
      </definition>
      

      <note>
	<p>
	  Por la <xref ref="obs-period"/> y la <xref ref="note-period"/>, el armónico <m>n</m>-ésimo de una serie trigonométrica de Fourier
	  es una <em>función periódica con período <m>T</m></em>, con total independencia del valor de <m>n</m>.
	  Eso sí, el <em>período fundamental</em> del <m>n</m>-ésimo armónico es <m>T/n</m>.
	</p>
      </note>
      
	    
      <p>
	El hecho que la sumación vaya hasta <m>n=\infty</m> en <xref ref="fourier-trig-synthesis"/> es una ficción matemática,
	que no se corresponde con la realidad física.

	No existe en la realidad ninguna función con frecuencia fundamental arbitrariamente grande,
	ya que debajo de la <url href="https://en.wikipedia.org/wiki/Planck_length">longitud de Planck</url> nuestro conocimiento de la realidad se acaba.

	Si en vez de hasta infinito sumamos solamente hasta cierto número arbitrario <m>N</m>, obtenemos
	una aproximación a la serie de Fourier con la cual podemos trabajar en la práctica.
      </p>

      <definition>
	<statement>
	  <p>
	    La aproximación hasta el <term><m>N</m>-ésimo armónico</term> (o hasta <term>grado <m>N</m></term>, u <term>orden <m>N</m></term>)
	    de la serie de Fourier
	    <md>
	    <mrow>
	      f(t)
	      &amp; = 
	      \frac{a_0}{2}
	      +
	      \sum_{n=1}^\infty
	      a_n
	      \cos\left(\omega_n t\right)	  +
	      \sum_{n=1}^\infty
	      b_n
	      \sin\left(\omega_n t\right)
	    </mrow>
	    <mrow>
	    &amp;=
	      \sum_{n=-\infty}^\infty
	      c_n
	      e^{\ii \omega_n t}
	    </mrow>
	    </md>

	    <p>
	      es
	    </p>

	    <md>
	    <mrow>
	      S_N(f)(t)
	      &amp;=
	      \frac{a_0}{2}
	      +
	      \sum_{n=1}^N
	      a_n
	      \cos(\omega_n t)	  +
	      \sum_{n=1}^N
	      b_n
	      \sin(\omega_n t)
	    </mrow>
	    
	    <mrow>
	      &amp; =
	      \sum_{n=-N}^N
	      c_n
	      e^{\ii \omega_n t}.
	    </mrow>
	    </md>
	  </p>
	</statement>

	<p>
	  La única diferencia entre estas dos expresiones es que en la primera sumamos hasta el infinito,
	  mientras que en la segunda solamente hasta <m>N</m>.
	</p>
	
      </definition>
      
    </subsection>
    
    
  </section>

  <section xml:id="section-gibbs">

    <title>Convergencia de una Serie de Fourier. Teorema de Dirichlet. El fenómeno de Gibbs</title>
    <introduction>
    <p>
      Hemos de distinguir claramente entre tres objetos:

      <ol>
	<li>
	  Una función periódica <m>f:\RR\to\RR</m> con período <m>T</m>
	</li>

	<li>
	  Su serie de Fourier
	  <me>
	    S(f)(t)
	    \ = \
	    \frac{a_0}{2}
	    +
	    \sum_{n=1}^\infty
	    a_n
	    \cos\left(\frac{2\pi n}{T}\, t\right)	  +
	    \sum_{n=1}^\infty
	    b_n
	    \sin\left(\frac{2\pi n}{T}\, t\right).
	  </me>
	</li>

	<li>
	  Una aproximación a la serie de Fourier con términos hasta orden <m>N</m>
	  <me>
	    S_N(f)(t)
	    \ = \
	    \frac{a_0}{2}
	    +
	    \sum_{n=1}^N
	    a_n
	    \cos\left(\frac{2\pi n}{T}\, t\right)	  +
	    \sum_{n=1}^N
	    b_n
	    \sin\left(\frac{2\pi n}{T}\, t\right).
	  </me>
	</li>
      </ol>
    </p>
    </introduction>

    <subsection>
      <title>
	Aproximación de funciones por series de Fourier
      </title>

      <p>
      Tomaremos como ejemplo las dos funciones de <xref ref="figure-fourier-approx0"/>.
      La primera, <m>f(x)</m>, parece más complicada que la segunda, al tener curvas y picos,
      mientras que la segunda, <m>g(x)</m> parece más sencilla, al estar compuesta únicamente por trozos constantes.
    </p>
    
    <sidebyside width="45%" margins="auto">

      <figure xml:id="figure-fourier-approx0">
	<caption>Una función contínua <m>f(x)</m> definida por trozos</caption>
	<image xml:id="figure-fourier-approx01" source="images/fig-series-piecewise.png">
	  <description>Una función contínua definida por trozos</description>
	</image>
      </figure>
      
      <figure xml:id="figure-fourier-approx0a">
	<caption>Una onda rectangular <m>g(x)</m> discontínua</caption>
	<image xml:id="figure-fourier-approx01a" source="images/fig-series-rectangle-wave.png">
	  <description>Una onda rectangular discontínua</description>
	</image>
      </figure>

    </sidebyside>

    <p>
      ¿Cuál de las dos funciones se podrá aproximar mejor por una serie de Fourier?
    </p>

    <p>
      Para contestar a esta pregunta, miramos <xref ref="figure-fourier-approx1"/> y <xref ref="figure-fourier-approx2"/>.
    </p>
    
    <figure xml:id="figure-fourier-approx1">
      <caption>Aproximación de la función contínua <m>f(x)</m> por su serie de Fourier hasta orden 3 (rojo) y orden 5 (azul)</caption>
      <image xml:id="figure-fourier-approx11" source="images/fig-series-approx-cont.png">
	<description>Aproximación de una función contínua por su serie de Fourier</description>
      </image>
    </figure>
    
    <figure xml:id="figure-fourier-approx2">
      <caption>
	Aproximación de la onda rectangular discontínua <m>g(x)</m>
	por su serie de Fourier hasta orden 5 (rojo) y orden 13 (azul)
      </caption>
      <image xml:id="figure-fourier-approx22" source="images/fig-series-approx-rect.png">
	<description>Aproximación de una onda rectangular por su serie de Fourier</description>
      </image>
    </figure>

    <p>
      Podemos ver varias cosas en estas imágenes:
    </p>

    <observation xml:id="obs_dirichlet">
      <p>
	<ol>
	  <li>
	    Las aproximaciones de <m>f(x)</m> son de orden 3 y 5,
	    las de <m>g(x)</m> de orden 5 y 13.
	    A pesar de utilizar un orden mucho mayor, la aproximación a <m>g(x)</m> es claramente peor.
	  </li>

	  <li>
	    A pesar de que <m>f(x)</m> tiene unos picos,
	    su aproximación por serie de Fourier es excelente incluso para un orden tan bajo como 5.
	    El único lugar donde se aprecia una diferencia entre <m>S_5(f)</m> y <m>f</m> es cerca del pico,
	    pero se ve que al aumentar el grado de la aproximación de 3 a 5, la aproximación mejora bastante.
	    Parece razonable esperar entonces que la aproximación mejore aún más si pasamos a mayores órdenes.
	  </li>

	  <li>
	    A pesar de utilizar órdenes bastante altos, la aproximación de <m>S_N(g)</m> a <m>g</m> nunca es realmente buena.
	    Es algo aceptable en el interior de los segmentos constantes,
	    pero bastante mala cerca de los puntos de discontinuidad.
	  </li>

	  <li>
	    Curiosamente, todas las aproximaciones a <m>g</m> pasan por el mismo punto cuando la función <m>g</m> hace su salto.
	  </li>

	  <li>
	    En las aproximaciones de <m>g</m>, justo antes y después del salto, las aproximaciones parecen <em>coger aire</em>
	    antes de lanzarse; y curiosamente, aunque las aproximaciones en la imágen son de órdenes muy dispares (5 y 13),
	    la altura de estos excesos antes y después del salto parece ser la misma.
	  </li>
	  
	</ol>
      </p>
    </observation>

    <p>
      Todas las observaciones que hemos hecho en estos dos ejemplos se extienden a funciones generales.
      Investigamos primero en qué condiciones una serie de Fourier es capaz de reproducir la función.
    </p>

  </subsection>
    
    <subsection>
      <title>El Teorema de Dirichlet</title>
      
      <definition>
	<title>Condiciones de Dirichlet</title>
	<statement>
	  <p>
	    Una función con valores reales <m>f:\RR\to\RR</m>
	    y periódica con período <m>T</m>
	    satisface las <term><url href="https://en.wikipedia.org/wiki/Dirichlet_conditions">Condiciones de Dirichlet</url></term> si
	    <ul>
	      <li>
		<m>f</m> es <term>absolutamente integrable</term> sobre un período. Eso quiere decir que
		<me>
		  \int_{T} |f(x)| \dd x
		  \ &lt; \
		  \infty.
		</me>
		Recordamos que
		<m>
		  \int_{T} |f(x)| \dd x
		  \ = \
		  \int_{x_0}^{x_0+T} |f(x)| \dd x,
		</m>
		donde la elección del valor <m>x_0</m> es arbitraria,
		ya que la integral valdrá lo mismo para todos los valores de <m>x_0</m>
		porque <m>f</m> es periódica con periodo <m>T</m>.
	      </li>

	      <li>
		<m>f</m> es de <url href="https://en.wikipedia.org/wiki/Bounded_variation">variación acotada</url>.
		Ésta es una condición técnica que no trataremos aquí, y que todas las funciones que tratamos satisfacen.
	      </li>

	      <li>
		En cualquier intervalo real acotado, por ejemplo un periodo,
		la función <m>f</m> tiene, como mucho, un número finito de puntos de discontinuidad,
		y los saltos que da en los puntos de discontinuidad no pueden ser infinitos.
	      </li>
	      
	    </ul>
	  </p>
	</statement>
      </definition>

      <theorem>
	<title>
	  <url href="https://en.wikipedia.org/wiki/Dirichlet_conditions">Teorema de Dirichlet</url>
	</title>

	<p>
	  Si <m>f(x)</m> satisface las condiciones de Dirichlet,
	  entonces su serie <m>S(f)(x)</m> de Fourier es convergente para todo <m>x\in\RR</m>,
	  y el valor de su serie en un punto concreto <m>x_0</m> es
	  <md>
	    <mrow>
	      S(f)(x_0)
	      &amp;=
	      \frac{a_0}{2}
	      +
	      \sum_{n=1}^\infty
	      a_n
	      \cos\left(\frac{2\pi n}{T}\, x_0\right)	  +
	      \sum_{n=1}^\infty
	      b_n
	      \sin\left(\frac{2\pi n}{T}\, x_0\right)
	    </mrow>

	    <mrow>
	      &amp;=
	      \frac{f(x_0^-) + f(x_0^+)}{2}.
	    </mrow>
	  </md>
	</p>

      </theorem>

      
      <p>
	Aquí hemos utilizado la siguiente notación para los <term><url href="https://en.wikipedia.org/wiki/One-sided_limit">límites laterales</url></term> de <m>f</m>:
	<ul>
	  <li>
	    <m>
	      f(x_0^-)
	      \ = \
	      \lim_{y\nearrow x_0} f(y),
	    </m>
	    es decir, <m>y</m> se aproxima a <m>x_0</m> por la izquierda,
	  </li>

	  <li>
	    <m>
	      f(x_0^+)
	      \ = \
	      \lim_{y\searrow x_0} f(y)
	    </m>
	    es decir, <m>y</m> se aproxima a <m>x_0</m> por la derecha.
	  </li>
	</ul>
      </p>
      

      <observation>
	<p>
	  Si la función <m>f(x)</m> es contínua en un punto <m>x_0</m>,
	  entonces los límites laterales de <m>f</m> en <m>x_0</m> coinciden,
	  <me>
	    f(x_0^-)
	    \ = \
	    f(x_0^+)
	    \ = \
	    f(x_0),
	  </me>
	  y por tanto

	  <me>
	    S(f)(x_0)
	    \ = \
	    \frac{f(x_0^-) + f(x_0^+)}{2}
	    \ = \
	    f(x_0).
	  </me>
	  Eso quiere decir que <em>en los puntos de continuidad de <m>f</m></em>,
	  <ul>
	    <li>
	      la aproximación de la serie de Fourier <m>S(f)</m> a <m>f</m> es perfecta,
	    </li>

	    <li>
	      y además, las aproximaciones <m>S_N(f)</m> a <m>S(f)</m> se hace cada vez mejores
	      si aumentamos el grado <m>N</m> de la aproximación.
	    </li>
	  </ul>
	  En cambio,
	  <em>en los puntos <m>x_0</m> donde <m>f</m> no es contínua</em>,
	  <ul>
	    <li>
	      el valor <m>S(f)(x_0)</m> de la serie de Fourier es el promedio de los límites laterales
	      de <m>f</m> alrededor de <m>x_0</m>,
	    </li>

	    <li>
	      y lo mismo vale para los valores de todas las aproximaciones <m>S_N(f)(x_0)</m>.
	    </li>
	  </ul>
	  
	</p>
      </observation>

    </subsection>

    <subsection>
      <title>El fenómeno de Gibbs</title>
      
      <p>
	Nos queda por explicar el último punto de <xref ref="obs_dirichlet"/>, que se conoce como el
	<url href="https://en.wikipedia.org/wiki/Gibbs_phenomenon">fenómeno de Gibbs</url>.
	Miramos las aproximaciones del pulso rectangular de orden 5, 25 y 125 de <xref ref="fig-gibbs-1"/>-<xref ref="fig-gibbs-3"/>.
      </p>

      <sidebyside  width="30%" margins="auto">

        <figure xml:id="fig-gibbs-1">
          <caption><url href="https://en.wikipedia.org/wiki/File:Gibbs_phenomenon_10.svg">Aproximación</url> con 5 harmónicos</caption>
          <image width="100%" source="images/200px-Gibbs_phenomenon_10">
            <description></description>
          </image>
        </figure>

        <figure xml:id="fig-gibbs-2">
          <caption><url href="https://en.wikipedia.org/wiki/File:Gibbs_phenomenon_50.svg">Aproximación</url> con 25 harmónicos</caption>
          <image width="100%" source="images/200px-Gibbs_phenomenon_50">
            <description></description>
          </image>
        </figure>

        <figure xml:id="fig-gibbs-3">
          <caption><url href="https://en.wikipedia.org/wiki/File:Gibbs_phenomenon_250.svg">Aproximación</url> con 125 harmónicos</caption>
          <image width="100%" source="images/200px-Gibbs_phenomenon_250">
            <description></description>
          </image>
        </figure>
	
      </sidebyside>

      <p>
	Vemos que según aumenta el orden de la aproximación,
	el error disminuye en amplitud pero converge a una altura fija.
	En <url href="https://en.wikipedia.org/wiki/Gibbs_phenomenon">esta página de la Wikipedia</url>
	se pueden encontrar los caĺculos que llevan a la siguiente afirmación:
      </p>

      <theorem>
	<title>El fenómeno de Gibbs</title>
	<p>
	  Si
	  <ul>
	    <li>
	      <m>f(x)</m> es una función contínua y diferenciable a trozos,
	    </li>

	    <li>
	      y en un punto de discontinuidad <m>x_0</m> tiene un salto de altura <m>a</m>,
	    </li>
	  </ul>
	  
	  entonces

	  <ol>
	    <li>
	      para valores grandes de <m>N\gg 0</m>,
	      la aproximación <m>S_N(f)</m> dará un salto de altura
	      <me>
		0.0895
		\,\cdot\,
		a	    
	      </me>
	      antes y después de <m>x_0</m>.
	      El salto total de la aproximación <m>S_N(f)</m> la serie de Fourier será, por tanto,
	      de unos <m>18\%</m> de la altura <m>a</m> del salto de <m>f</m>.
	    </li>

	    <li>
	      En el lugar de la discontinuidad, la aproximación <m>S_N(f)</m> la serie de Fourier
	      converge al punto medio del salto,
	      con total independencia del valor <m>f(x_0)</m> (si está siquiera definido).
	    </li>
	  </ol>
	</p>
      </theorem>

      <p>
	En dos dimensiones, un efecto análogo al fenómeno de Dirichlet se llama un
	<term><url href="https://en.wikipedia.org/wiki/Ringing_artifacts">Artefacto de anillo</url></term>,
	compara <xref ref="fig-ringing"/>.
      </p>

      <figure xml:id="fig-ringing">
	<caption>
	  Imagen mostrando <url href="https://es.wikipedia.org/wiki/Artefactos_de_anillo">artefactos de anillo</url>.
	  Tres niveles en cada lado de la transición: el rebasamiento, el primer anillo y el segundo anillo (más débil).
	</caption>
	<image width="80%" source="images/Ringing_artifact_example.png"/>
      </figure>
      
    </subsection>
    
  </section>

  <section>
    <title>Espectro</title>

    <p>
      Consideramos una señal <m>x(t)</m> de periodo <m>T</m> y frecuencia fundamental <m>\omega_0=\frac{2\pi}{T}</m>.
      Para poder leer la información contenida en los coeficientes de Fourier trigonométricos y complejos de <m>x(t)</m> de manera rápida e intuitiva,
      necesitamos una representación gráfica, el <em>espectro</em> de <m>x(t)</m>.
    </p>

    <p>
      Puesto que la forma trigonométrica y la forma compleja de la transformada de Fourier de <m>x(t)</m>,
      <md>
	<mrow>
	    f(t)
	    &amp; \ = \
	    \frac{a_0}{2}
	    +
	    \sum_{n=1}^\infty
	    a_n
	    \cos\left(\frac{2\pi n}{T}\, t\right)
	    +
	    \sum_{n=1}^\infty
	    b_n
	    \sin\left(\frac{2\pi n}{T}\, t\right)
	</mrow>
	<mrow>
	  &amp; \ = \
	  \sum_{n=-\infty}^\infty
	  c_n
	  e^{\ii \frac{2\pi n}{T}\, t}
	</mrow>
      </md>
      son algo distintas, hay una versión del espectro para cada una.
    </p>
    
    <definition>
      <title>Espectro real</title>
      <statement>
	<p>
	  Las componentes del <term>espectro real</term> se definen a partir de los coeficientes de la serie de Fourier trigonométrica.

	  <ul>
	    <li>
	      Para el término DC o constante, que corresponde a <m>n=0</m>, se escoge el valor <m>\frac{1}{2}|a_0|</m>.
	    </li>

	    <li>
	      Para los términos AC, el <m>n</m>-ésimo de los cuales corresponde al múltiplo <m>n</m>ésimo de la frecuencia fundamental,
	      con <m>n\ge1</m>,
	      se escoge el valor <m>\sqrt{a_n^2+b_n^2}</m>.
	    </li>
	  </ul>
	  
	  La <em>representación gráfica</em> del espectro real consiste, por tanto, del conjunto de puntos en el plano
	  <me>
	    \left(0, \tfrac{1}{2}|a_0|\right)
	    \quad\bigcup\quad
	    \left\{
	    \left(n\omega_0,\sqrt{a_n^2+b_n^2}\right) : n\ge 1
	    \right\}.
	  </me>
	</p>
      </statement>
    </definition>

    <example>
      <p>
	Consideramos la señal 
	<men xml:id="example-real-spec-func">
	  x(t)
	  \ = \
	  \frac12
	  -
	  \frac13 \sin t
	  +
	  \frac14 \cos 2t
	</men>
	que tiene período fundamental <m>T=2\pi</m>
	y frecuencia fundamental <m>\omega_0=1</m>.
	En la <xref ref="figure-real-spectrum-example"/> podemos ver la representación de esta señal y su espectro real.
	Las componentes del espectro se calculan de la siguiente manera:
	<ul>
	  <li>
	    De <xref ref="example-real-spec-func"/> deducimos que <m>\frac{a_0}{2} = \frac12</m>.
	    Esta constante contribuye el punto <m>(0,0.5)</m> al espectro.
	  </li>

	  <li>
	    Del término <m>-\frac13\sin t</m> deducimos que <m>b_1 = -\frac13</m>.
	    No hay ningún término de la forma <m>\cos t</m>, por tanto <m>a_1=0</m> y no hay más contribuciones al armónico <m>n=1</m>.
	    La contribución del primer armónico es
	    <me>
	      \sqrt{a_1^2 + b_1^2}
	      \ = \
	      \sqrt{0^2 + \left(-\frac13\right)^2}
	      \ = \
	      \frac13,
	      </me>
	      y obtenemos el punto <m>(1\cdot\omega_0,\frac13) = (1,0.33)</m>.
	  </li>

	  <li>
	    Finalmente,
	    del término <m>\frac14\cos 2t</m> deducimos el punto <m>(2\omega_0,\frac14) = (2,.25)</m>.
	  </li>
	  
	</ul>
	
	  
      </p>
    </example>

    <figure xml:id="figure-real-spectrum-example">
      <caption>
	<p>
	  <em>Izquierda:</em>
	  La señal 
	  <m>
	  x(t)
	  \ = \
	  \frac12
	  -
	  \frac13 \sin t
	  +
	  \frac14 \cos 2t
	  </m>
	  (azul) descompuesta en sus tres componentes.
	  <em>Derecha:</em>
	  El espectro real de <m>x(t)</m>
	</p>
	
      </caption>
      <image source="images/fig-series-signal-and-spect.png">
      <description>
	Una señal y su espectro real
      </description>
      </image>
    </figure>

    <p>
      El <em>espectro complejo</em>, al igual que el espectro real, resalta la importancia de cada armónico en la sintesis de la señal. 
      La diferencia es que se define a partir de los coeficientes de Fourier compleja:
    </p>

    <definition>
      <title>Espectro complejo</title>
      <statement>	
	<p>
	  Las componentes del <term>espectro complejo</term> se definen a partir de los coeficientes de la serie de Fourier compleja.
	  <ul>
	    <li>
	      El armónico <m>n</m>-ésimo, para <m>n\in\ZZ</m>,
	      que corresponden a la frecuencia 0 y a los múltiplos positivos y negativos de la frecuencia fundamental,
	      contribuye los puntos del plano <m>(n\omega_0, |c_n|)</m>.
	    </li>
	  </ul>
	</p>
      </statement>
    </definition>

    <figure xml:id="figure-complex-spectrum-example">
      <caption>
	<p>
	  <em>Izquierda:</em>
	  La señal 
	  <m>
	  x(t)
	  \ = \
	  \frac12
	  -
	  \frac13 \sin t
	  +
	  \frac14 \cos 2t
	  </m>
	  (azul) descompuesta en sus tres componentes.
	  <em>Derecha:</em>
	  El espectro complejo de <m>x(t)</m>
	</p>
	
      </caption>
      <image source="images/fig-series-complex-spect.png">
      <description>
	Una señal y su espectro complejo
      </description>
      </image>
    </figure>
    
    <note>
      <p>  
	Como los coeficientes reales y complejos de la serie de Fourier están relacionados, los espectros también lo son. 
	Da las relaciones <xref ref="convert-c-to-ab-1"/>, <xref ref="convert-c-to-ab-2"/>, <xref ref="convert-c-to-ab-3"/>
	entre los coeficientes reales y complejos
	obtenemos la relación entre los espectros:

	<ul>
	  <li>
	    <m>|c_0|=\frac{1}{2}|a_0|</m>.
	  </li>

	  <li>
	    <m>|c_{-n}|=|c_n|=\left|\frac{1}{2}\right|\left|a_n+\ii b_n\right|=\frac{1}{2}\sqrt{a_n^2+b_n^2}</m>.
	  </li>
	</ul>
	  
      </p>

    </note>

    <note>
      <p>
	Cuando calculamos el espectro de una señal, sólo tenemos en cuenta el valor absoluto de los coeficientes complejos,
	no los coeficentes mismos.
	En consecuencia, hay señales con coeficientes distintos, y por lo tanto con gráficas distintas, que sin embargo tienen el mismo espectro.
      </p>
    </note>
    
    <figure xml:id="figure-same-spectrum">
      <caption>
	Tres señales con coeficientes distintos, pero el mismo espectro
      </caption>
          <image source="images/fig-series-same-spect.png">
      <description>
	Tres señales con coeficientes distintos, pero el mismo espectro
      </description>
      </image>
    </figure>
    <example>
      <p>
	En la <xref ref="figure-same-spectrum"/> vemos las señales
	<md>
	  <mrow>
	    x_1(t)
	    &amp;\ = \
	    \tfrac12 - \tfrac13 \sin t  + \tfrac14  \cos 2t,
	  </mrow>
	  <mrow>
	    x_2(t)
	    &amp;\ = \
	    \tfrac12 - \tfrac13 \cos t  + \tfrac14  \cos 2t,
	  </mrow>
	  <mrow>
	    x_3(t)
	    &amp;\ = \
	    \tfrac12 - \tfrac15 \cos t  + \tfrac{4}{15} \sin t  + \tfrac14 \cos 2t,
	  </mrow>
	</md>
	que tienen el mismo espectro.
      </p>

      <p>
	Eso se debe a que los coeficientes
	<me>
	  a_0/2
	  \ = \
	  \tfrac12,
	  \qquad
	  a_2
	  \ = \
	  \tfrac14
	</me>
	son los mismos en las tres señales, y los coeficientes del primer armónico (<m>n=1</m>) contribuyen lo mismo al espectro:
	<ul>
	  <li>
	      En el caso de <m>x_1(t)</m> el primer armónico es <m>-\tfrac13\sin t</m>,
	      que tiene <m>a_1=0</m>, <m>b_1=-\tfrac13</m> y contribuye
	      <me>
		\sqrt{a_1^2 + b_1^2}
		\ = \
		\sqrt{0^2 + \left(-\frac{1}{3}\right)^2}
		\ = \
		\frac13.
	      </me>
	  </li>

	  <li>
	      En el caso de <m>x_2(t)</m> el primer armónico es <m>-\tfrac13\cos t</m>,
	      que tiene <m>a_1=-\tfrac13</m>, <m>b_1=0</m> y contribuye
	      <me>
		\sqrt{a_1^2 + b_1^2}
		\ = \
		\sqrt{\left(-\frac{1}{3}\right)^2 + 0^2}
		\ = \
		\frac13.
	      </me>
	  </li>

	  <li>
	      En el caso de <m>x_3(t)</m> el primer armónico es <m>-\tfrac15\cos t + \tfrac{4}{15}\sin t</m>,
	      que tiene <m>a_1=-\tfrac15</m>, <m>b_1=\tfrac{4}{15}</m> y contribuye
	      <me>
		\sqrt{a_1^2 + b_1^2}
		\ = \
		\sqrt{\left(-\frac{1}{5}\right)^2 + \left(\frac{4}{15}\right)^2}
		\ = \
		\sqrt{\frac{1}{25} + \frac{16}{225}}
		\ = \
		\sqrt{\frac{9 + 16}{225}}
		\ = \
		\frac{5}{15}
		\ = \
		\frac13.
	      </me>
	  </li>
	  
	</ul>
      </p>

    </example>

  </section>

  <section>
    <title>Energía y relación de Parseval</title>

    <subsection>
      <title>
	Energía, potencia media, densidad espectral de energía
      </title>
    
    <theorem xml:id="theorem-parseval-series">
      <title>Relación de Parseval para series de Fourier</title>
      <p>
	Consideramos una señal <m>x(t)</m> de periodo <m>T</m> y los coeficientes complejos
	<m>c_n</m>, <m>n\in\ZZ</m>, de la serie de Fourier asociada a <m>x(t)</m>.

	Si la integral
	<me>
	  \int_T \left|x(t)\right|^2
	  \dd t
	</me>
	es convergente, 
	entonces se cumple que
	<me>
	  \int_T \left|x(t)\right|^2
	  \dd t
	  \ = \
	  T \sum_{n=-\infty}^\infty |c_n|^2.
	</me>
      </p>
    </theorem>

    <p>
      En este teorema, <m>\int_T \dd t</m> quiere decir <em>integrar sobre cualquier intervalo de longitud <m>T</m></em>,
      por ejemplo cualesquiera de los intervalos <m>[0,T], [-T,0], [-T/2,T/2]</m>.
    </p>
    
    <p>
      Las expresiones que intervienen en este teorema
      reciben diversos nombres.
    </p>

    <definition xml:id="def-energy-series">
      <title>
	Energía, potencia media, densidad espectral de energía
      </title>
      <statement>
      <p>
	<ol>
	  
	  <li>
	    <p>
	      La integral
	      <me>
		E\big(x(t);T\big)
		\ = \
		\int_T \left|x(t)\right|^2
		\dd t
	      </me>
	      (que es un número) es el
	      <term>valor de la energía</term>
	      de la señal <m>x(t)</m> en un intervalo de longitud el periodo <m>T</m>.
	    </p>
	    
	    <p>
	      Anotamos que para señales periódicas no tiene sentido hablar de
	      la energía total de la señal, que será siempre infinita.
	      Por tanto, aquí no consideramos
	      <m>
		\int_{-\infty}^\infty
		|x(t)|^2 \dd t.
	      </m>
	    </p>
	    
	  </li>

	  <li>
	    La integral
	    <me>
	      \overline{P}\big(x(t); T\big)
	      \ = \
	      \frac{1}{T}
	      \int_T \left|x(t)\right|^2
	      \dd t
	      \ = \
	      \frac{1}{T}\cdot
	      E\big(x(t);T\big).
	    </me>
	    es la <term>potencia media</term> de la señal.
	  </li>

	  <li>
	    El número
	    <md>
	      <mrow>
		E_{\spec}\big(x(t); T\big)
		&amp; \ = \
		T \sum_{n=-\infty}^\infty |c_n|^2
	      </mrow>

	      <mrow>
		&amp; \ = \
		T \left(
		\left(\frac{a_0}{2}\right)^2 +
		\sum_{n=1}^\infty 2\cdot\frac{a_n^2 + b_n^2}{4}
		\right)
	      </mrow>

	      <mrow>
		&amp; \ = \
		T \cdot \frac{a_0^2}{4} +
		T \cdot \sum_{n=1}^\infty \frac{a_n^2 + b_n^2}{2}
	      </mrow>
	    </md>
	    es la
	    <term>energía espectral total</term>.
	    Hemos utilizado las fórmulas <xref ref="convert-c-to-ab-1"/>, <xref ref="convert-c-to-ab-2"/>, <xref ref="convert-c-to-ab-3"/> para convertir los coeficientes complejos a los reales.
	    
	  </li>
	  
	  <li>
	    La sucesión de números <m>T\, |c_n|^2</m> para <m>n = 0, \pm1, \pm2, \pm3, \dots</m>, es la
	    <term>densidad espectral de energía</term>
	    de la señal <m>x(t)</m>.
	    Muestra como está dispersada la energía de la señal en función de la
	    frecuencia angular <m>\omega</m>: cada <m>n</m> se corresponde con la frecuencia
	    <m>\omega_n = n \omega_0</m>, siendo <m>\omega_0 = \frac{2\pi}{T}</m> la frecuencia fundamental de la señal.
	  </li>
	  
	</ol>
	
      </p>
      </statement>
    </definition>

    <note>
      <title>Efecto de las diferentes convenciones</title>
      <p>
	Recordamos que hay dos convenciones diferentes para el coeficiente constante de la serie de Fourier de una función <m>f:\RR\to\RR</m>:
	<md>
	  <mrow>
	  S_f(\omega)
	  &amp;\ = \
	  \widetilde{a_0} +\sum_{n\ge 1} a_n\cos(n \omega_0 t) + b_n\sin(n \omega_0 t)
	  </mrow>
	  <mrow>
	    &amp;\ = \
	    \frac{a_0}{2} +\sum_{n\ge 1} a_n\cos(n \omega_0 t) + b_n\sin(n \omega_0 t)
	  </mrow>
	</md>
	¿Cómo afecta eso al cálculo de la energía contenida en la señal?
      </p>

      <p>
	Supongamos a modo de ejemplo que
	<me>
	  S_f(\omega)
	  \ = \
	  8
	  + 3\cos(3\omega_0t)
	  - 4\cos(5\omega_0 t)
	  + 2\sin(5\omega_0 t) + \dots
	  .
	</me>

	En la primera convención,
	<me>
	  \widetilde{a_0}
	  \ = \ 8,
	</me>
	mientras que en la segunda convención,
	<me>
	\frac{a_0}{2}
	\ = \
	8
	\quad\Rightarrow\quad
	a_0 \ = \ 16.
	</me>
	Pero para calcular la energía, el resultado es el mismo:
	<md>
	  <mrow>
	    \frac{\text{energía}}{T}
	    &amp; \ = \
	    \text{cuadrado del coeficiente constante al cuadrado}
	  </mrow>

	  <mrow>
	    &amp; \qquad +
	    (1/2) \text{ suma sobre los demás coeficientes al cuadrado}
	  </mrow>

	  <mrow>
	    &amp; \ = \
	    8^2 + \frac12\left(
	    \underbrace{3^2}_{\text{tercer armónico}}
	    + \underbrace{\left(\sqrt{4^2 + 2^2}\right)^2}_{\text{quinto armónico}}
	    + \cdots\right)
	  </mrow>

	  <mrow>
	    &amp; \ = \
	    \widetilde{a_0}^2 + \frac12\Big(3^2 + 4^2 + 2^2 + \cdots\Big)
	  </mrow>

	  <mrow>
	    &amp; \ = \
	    \left(\frac{a_0}{2}\right)^2 +  \frac12\Big(3^2 + 4^2 + 2^2 + \cdots\Big).
	  </mrow>
	</md>

	La única diferencia consiste en si llamamos <m>\widetilde{a_0}</m> ó <m>a_0/2</m> al coeficiente constante <m>8</m> de la serie.
	</p>
    </note>
    

    </subsection>
    
    <subsection>
      <title>Aplicación: Aproximación en términos de energía</title>

      <p>
	Una de las aplicaciones de la identidad de Parseval consiste en evaluar
	en términos energéticos una suma parcial de la serie de Fourier (o unos
	cuantos términos de la serie de Fourier) como aproximación de la señal
	<m>x(t)</m>.
      </p>

      <p>
	Supongamos que consideramos la suma parcial de Fourier de orden <m>k</m>
	<me>
	  S_k(t)
	  \ = \
	  \sum_{n=-k}^k
	  c_n\, e^{\ii \omega_n t},
	</me>
	que es una aproximación de la señal original:
	<me>
	  S_k(t)
	  \ \approx\
	  x(t).
	</me>
      </p>

      <p>
	Nuestra meta es valorar esta aproximación en términos de energía,
	utilizando la identidad de Parseval.
	
	Para ello, hacemos la suma de los términos <m>|c_n|^2</m>
	que intervienen en la aproximación <m>S_k(t)</m> y multiplicamos la suma por el periodo <m>T</m>:
	<me>
	  E_k(t)
	  \ := \
	  E_{\spec}\big(S_k(t);T\big)
	  \ = \
	  T\sum_{n=-k}^k
	  |c_n|^2.
	</me>
	Esta expresión representa la energía espectral de la aproximación,
	y la comparamos con la energía espectral total.
      </p>

      <p>
	Pero por la identidad de Parseval sabemos que la energía
	espectral total es igual a la energía total en un periodo, y lo que comparamos es
	la energía espectral de la aproximación con la energía total en un periodo.
	Obtenemos por tanto:
      </p>

      <definition xml:id="def-energy-proportion">
	<title>Proporción de energía en la aproximación</title>
	<statement>
	<p>
	  Sea
	  <m>
	    S_k(t)
	    \ = \
	    \sum_{n=-k}^k
	    c_n\, e^{\ii \omega_n t}
	  </m>
	  la suma parcial de Fourier de orden <m>k</m>
	  de la señal <m>x(t)</m>.
	</p>
	<p>
	  Entonces la <term>proporción de la energía</term> de <m>x(t)</m>
	  que reside en la aproximación <m>S_k(t)</m> es
	  <md>
	    <mrow>
	      \varepsilon_{k}\big(x(t)\big)
	      &amp;
	      \ = \
	      \frac{T\sum_{n=-k}^k |c_n|^2}{\int_T |x(t)|^2\dd t}
	      \ = \
	      \frac{E_k(t)}{\overline{E}\big(x(t);T\big)}
	    </mrow>
	  </md>
	</p>
	</statement>
      </definition>

    </subsection>
      
  </section>


  
  
</chapter>
